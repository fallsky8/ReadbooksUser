<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.readbooks.noticeboarddao.NoticeBoardDAO">
	<sql id="noticeboardCommon">
		SELECT noticeboard_number, NOTICEBOARD_WRITER, NOTICEBOARD_TITLE,
		NOTICEBOARD_REGISTERDATE FROM tbl_noticeboard
		<trim prefixOverrides="AND" prefix="WHERE">
			<if test="search=='noticeboard_title'">
<![CDATA[noticeboard_title LIKE'%'||#{keyword}||'%']]>
			</if>
			<if test="search=='NOTICEBOARD_CONTENTS'">
<![CDATA[AND NOTICEBOARD_CONTENTS LIKE'%'||#{keyword}||'%']]>
			</if>
			<if test="search=='NOTICEBOARD_WRITER'">
<![CDATA[AND NOTICEBOARD_WRITER LIKE'%'||#{keyword}||'%']]>
			</if>
		</trim>
	</sql>
	<select id="noticeboardList" parameterType="noticeboard"
		resultType="noticeboard">
		SELECT noticeboard_number, NOTICEBOARD_WRITER, NOTICEBOARD_TITLE,
		to_char(NOTICEBOARD_REGISTERDATE,'YYYY-MM-DD HH24:MI:SS')
		as
		NOTICEBOARD_REGISTERDATE FROM (SELECT list.*,ROWNUM AS RNUM FROM(
		<include refid="noticeboardCommon" />


		<choose>

			<when test="order_by=='noticeboard_number'"> ORDER BY noticeboard_number </when>

			<when test="order_by=='noticeboard_registerdate'"> ORDER BY noticeboard_registerdate </when>

		</choose>


		<choose>

			<when test="order_sc=='ASC'"> ASC </when>

			<when test="order_sc=='DESC'"> DESC </when>

		</choose>
		)list )

		<where>


			<if test="start_row != null and start_row !=''">

				<if test="end_row != null and end_row !=''"> RNUM BETWEEN #{start_row} AND #{end_row} </if>

			</if>

		</where>

	</select>
	<select id="noticeboardListCnt" resultType="int" parameterType="noticeboard">
		SELECT NVL(count(1),0)FROM ( SELECT list.*, ROWNUM AS RNUM FROM(
		<include refid="noticeboardCommon" />
		ORDER BY noticeboard_number desc )list )
	</select>
</mapper>
